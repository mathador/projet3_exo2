<mxfile host="65bd71144e">
    <diagram id="aLv0uj-dzSr5ACx-b04U" name="Diag Seq Ajout Tag">
        <mxGraphModel dx="2453" dy="779" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="2" value="sequenceDiagram&#xa;    actor U as Utilisateur&#xa;    participant D as Dashboard&#xa;    participant TF as TagForm (React)&#xa;    participant RTK as useAddTagMutation&lt;br/&gt;RTK Query&#xa;    participant API as API /tags (monolith)&#xa;    participant DB as Base de données&#xa;&#xa;    %% Affichage du formulaire&#xa;    U -&gt;&gt; D: Ouvre la page Dashboard&#xa;    D -&gt;&gt; TF: Rend le composant TagForm&#xa;&#xa;    %% Saisie du tag&#xa;    U -&gt;&gt; TF: Saisit le nom du tag&#xa;    U -&gt;&gt; TF: Clique sur &quot;Créer le tag&quot;&lt;br/&gt;(submit du formulaire)&#xa;&#xa;    %% Validation côté client&#xa;    TF -&gt;&gt; TF: handleSubmit(e)\n e.preventDefault()&#xa;    TF -&gt;&gt; TF: Vérifie tagName.trim()\n(si vide)&#xa;    alt tagName vide&#xa;        TF -&gt;&gt; TF: setError(&quot;Le nom du tag ne peut pas être vide.&quot;)&#xa;        TF -&gt;&gt; U: Affiche le message d’erreur&#xa;    else tagName non vide&#xa;        TF -&gt;&gt; TF: setStatus(&quot;loading&quot;)\nsetError(null)&#xa;&#xa;        %% Appel de la mutation RTK Query&#xa;        TF -&gt;&gt; RTK: addTag(tagName)&#xa;        activate RTK&#xa;        RTK -&gt;&gt; API: POST /tags\nBody: { name: tagName }\nHeaders: Authorization + Accept&#xa;        activate API&#xa;&#xa;        %% Traitement côté serveur&#xa;        API -&gt;&gt; DB: Insère le nouveau tag&#xa;        DB --&gt;&gt; API: Tag créé (id, name, ...)&#xa;        API --&gt;&gt; RTK: 201 Created\nBody: tag créé&#xa;        deactivate API&#xa;&#xa;        %% Réception côté client&#xa;        RTK --&gt;&gt; TF: Résultat de addTag().unwrap()&#xa;        deactivate RTK&#xa;&#xa;        %% Mise à jour de l’état UI&#xa;        TF -&gt;&gt; TF: setTagName(&quot;&quot;)\nsetStatus(&quot;succeeded&quot;)&#xa;        TF -&gt;&gt; U: Affiche &quot;Tag créé avec succès !&quot;&#xa;&#xa;        %% Invalidations de cache RTK Query&#xa;        RTK -&gt;&gt; RTK: invalidatesTags: [ { type: &#39;Tag&#39;, id: &#39;LIST&#39; } ]&#xa;        RTK -&gt;&gt; RTK: Déclenche refetch de getTags (si utilisé)&#xa;        RTK -&gt;&gt; API: GET /tags&#xa;        API --&gt;&gt; RTK: Liste des tags mise à jour&#xa;        RTK --&gt;&gt; D: Met à jour les composants abonnés\n(ex: TagList)&#xa;    end&#xa;&#xa;    %% Gestion d’erreur réseau / serveur&#xa;    opt Erreur API ou réseau&#xa;        RTK --&gt;&gt; TF: Erreur (exception unwrap)&#xa;        TF -&gt;&gt; TF: setError(err.message\n|| &quot;La création du tag a échoué.&quot;)\nsetStatus(&quot;failed&quot;)&#xa;        TF -&gt;&gt; U: Affiche le message d’erreur&#xa;    end" style="shadow=0;dashed=0;align=left;strokeWidth=1;shape=mxgraph.mermaid.abstract.mermaid;labelBackgroundColor=#ffffff;noLabel=1;theme=default;" vertex="1" parent="1">
                    <mxGeometry x="-200" y="150" width="1480" height="1480" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>